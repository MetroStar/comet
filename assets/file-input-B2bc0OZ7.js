import{j as x}from"./jsx-runtime-Bxcv0yjW.js";import{g as W}from"./_commonjsHelpers-BosuxZz1.js";import{s as j}from"./select-or-matches-Bu-g4rUn.js";import{b as Z,c as X}from"./config-BXli1stc.js";import{s as Y}from"./sanitizer-BtXph-xc.js";import{r as I}from"./index-mfbfsM12.js";import{F as k}from"./form-group-BYOOw0zj.js";const P=j,z=Z,$=Y,{prefix:l}=X,g=`${l}-file-input`,L=`.${g}`,F=`${l}-file-input__input`,T=`${l}-file-input__target`,O=`.${F}`,Q=`${l}-file-input__box`,V=`${l}-file-input__instructions`,N=`${l}-file-input__preview`,M=`${l}-file-input__preview-heading`,S=`${l}-file-input--disabled`,J=`${l}-file-input__choose`,H=`${l}-file-input__accepted-files-message`,D=`${l}-file-input__drag-text`,E=`${l}-file-input--drag`,R="is-loading",v="has-invalid-file",h=`${l}-file-input__preview-image`,K=`${h}--generic`,ee=`${h}--pdf`,te=`${h}--word`,se=`${h}--video`,ne=`${h}--excel`,B=`${l}-sr-only`,m="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";let b=!0,y="",C="";const _=e=>{const t=e.closest(L);if(!t)throw new Error(`Element is missing outer ${L}`);const s=t.querySelector(O);return{dropZoneEl:t,inputEl:s}},re=e=>{const{dropZoneEl:t,inputEl:s}=_(e);s.disabled=!0,t.classList.add(S)},ie=e=>{const{dropZoneEl:t}=_(e);t.classList.add(S)},ae=e=>{const{dropZoneEl:t,inputEl:s}=_(e);s.disabled=!1,t.classList.remove(S),t.removeAttribute("aria-disabled")},oe=e=>{const t=e.charCodeAt(0);return t===32?"-":t>=65&&t<=90?`img_${e.toLowerCase()}`:`__${t.toString(16).slice(-4)}`},le=e=>e.replace(/[^a-z0-9]/g,oe),ce=e=>`${e}-${Math.floor(Date.now().toString()/1e3)}`,G=e=>e.hasAttribute("multiple")?"files":"file",de=e=>{const t=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div");return e.classList.remove(g),e.classList.add(F),t.classList.add(g),n.classList.add(Q),s.classList.add(T),s.prepend(n),e.parentNode.insertBefore(s,e),e.parentNode.insertBefore(t,s),s.appendChild(e),t.appendChild(s),s},ue=e=>{const t=e.closest(L),s=G(e),n=document.createElement("div"),r=`Drag ${s} here or`,a="choose from folder";return y=`${r} ${a}`,n.classList.add(V),n.setAttribute("aria-hidden","true"),e.setAttribute("aria-label",y),n.innerHTML=$.escapeHTML`<span class="${D}">${r}</span> <span class="${J}">${a}</span>`,e.parentNode.insertBefore(n,e),(/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.querySelector(`.${D}`).outerHTML=""),n},pe=e=>{const t=document.createElement("div"),s=G(e),n=e.closest(L),r=e.closest(`.${T}`);C=`No ${s} selected.`,t.classList.add(B),t.setAttribute("aria-live","polite"),t.textContent=C,n.insertBefore(t,r)},fe=e=>{const t=e.hasAttribute("aria-disabled")||e.hasAttribute("disabled"),s=de(e),n=ue(e),{dropZoneEl:r}=_(e);return t?r.classList.add(S):pe(e),{instructions:n,dropTarget:s}},U=(e,t)=>{const s=e.querySelectorAll(`.${N}`),n=e.querySelector(`.${M}`),r=e.querySelector(`.${H}`),a=i=>{i.parentNode.removeChild(i)};n&&(n.outerHTML=""),r&&(r.outerHTML="",e.classList.remove(v)),s!==null&&(t&&t.removeAttribute("hidden"),Array.prototype.forEach.call(s,a))},me=(e,t,s)=>{const n=e;let r=C;t.length===1?r=`You have selected the file: ${s}`:t.length>1&&(r=`You have selected ${t.length} files: ${s.join(", ")}`),setTimeout(()=>{n.textContent=r},1e3)},he=(e,t)=>{const s=document.createElement("div"),n=e.closest(`.${T}`),r=n.querySelector(`.${V}`);let a="Change file",i="";t.length===1?i=$.escapeHTML`Selected file <span class="usa-file-input__choose">${a}</span>`:t.length>1&&(a="Change files",i=$.escapeHTML`${t.length} files selected <span class="usa-file-input__choose">${a}</span>`),r.setAttribute("hidden","true"),s.classList.add(M),s.innerHTML=i,n.insertBefore(s,r),e.setAttribute("aria-label",a)},Ae=(e,t,s,n)=>{const r=e.target.files,i=n.closest(`.${g}`).querySelector(`.${B}`),d=[];U(n,s);for(let c=0;c<r.length;c+=1){const p=new FileReader,o=r[c].name;let f;d.push(o),p.onloadstart=function(){f=ce(le(o)),s.insertAdjacentHTML("afterend",$.escapeHTML`<div class="${N}" aria-hidden="true">
          <img id="${f}" src="${m}" alt="" class="${h} ${R}"/>${o}
        <div>`)},p.onloadend=function(){const u=document.getElementById(f);o.indexOf(".pdf")>0?u.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${ee}")`):o.indexOf(".doc")>0||o.indexOf(".pages")>0?u.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${te}")`):o.indexOf(".xls")>0||o.indexOf(".numbers")>0?u.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${ne}")`):o.indexOf(".mov")>0||o.indexOf(".mp4")>0?u.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${se}")`):u.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${K}")`),u.classList.remove(R),u.src=p.result},r[c]&&p.readAsDataURL(r[c])}r.length===0?t.setAttribute("aria-label",y):he(t,r),me(i,r,d)},ge=(e,t,s,n)=>{const r=t.getAttribute("accept");n.classList.remove(v);const a=(i,d)=>{let c=!1;return i.indexOf(d)>=0&&(c=!0),c};if(r){const i=r.split(","),d=document.createElement("div");let c=!0;const p=e.target.files||e.dataTransfer.files;for(let o=0;o<p.length;o+=1){const f=p[o];if(c)for(let A=0;A<i.length;A+=1){const u=i[A];if(c=f.name.indexOf(u)>0||a(f.type,u.replace(/\*/g,"")),c){b=!0;break}}else break}c||(U(n,s),t.value="",n.insertBefore(d,t),d.textContent=t.dataset.errormessage||"This is not a valid file type.",d.classList.add(H),n.classList.add(v),b=!1,e.preventDefault(),e.stopPropagation())}},Le=(e,t,s,n)=>{ge(e,t,s,n),b===!0&&Ae(e,t,s,n)},_e=z({},{init(e){P(L,e).forEach(t=>{const{instructions:s,dropTarget:n}=fe(t);n.addEventListener("dragover",function(){this.classList.add(E)},!1),n.addEventListener("dragleave",function(){this.classList.remove(E)},!1),n.addEventListener("drop",function(){this.classList.remove(E)},!1),t.addEventListener("change",r=>Le(r,t,s,n),!1)})},teardown(e){P(O,e).forEach(t=>{const s=t.parentElement.parentElement;s.parentElement.replaceChild(t,s),t.className=g})},getFileInputContext:_,disable:re,ariaDisable:ie,enable:ae});var $e=_e;const q=W($e),w=({id:e,required:t,label:s,helperText:n,errors:r,...a})=>{const i=I.useRef(null);return I.useLayoutEffect(()=>{const d=i.current;return q.on(d),()=>q.off(d)},[]),x.jsx(k,{id:`form-group-${e}`,required:t,label:s,helperText:n,errors:r,fieldControl:x.jsx("input",{className:"usa-file-input",type:"file",ref:i,id:e,...a})})};try{w.displayName="FileInput",w.__docgenInfo={description:"File input allows users to attach one or multiple files.",displayName:"FileInput",props:{id:{defaultValue:null,description:"The unique identifier for this component",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"The name for the file input field",name:"name",required:!1,type:{name:"string"}},required:{defaultValue:null,description:"A boolean indicating whether or not the field is required",name:"required",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"Label text to display with the input",name:"label",required:!1,type:{name:"string"}},helperText:{defaultValue:null,description:"Helper text to display with the input",name:"helperText",required:!1,type:{name:"string"}},errors:{defaultValue:null,description:"An array of string error messages",name:"errors",required:!1,type:{name:"string | string[]"}}}}}catch{}try{fileinput.displayName="fileinput",fileinput.__docgenInfo={description:"File input allows users to attach one or multiple files.",displayName:"fileinput",props:{id:{defaultValue:null,description:"The unique identifier for this component",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"The name for the file input field",name:"name",required:!1,type:{name:"string"}},required:{defaultValue:null,description:"A boolean indicating whether or not the field is required",name:"required",required:!1,type:{name:"boolean"}},label:{defaultValue:null,description:"Label text to display with the input",name:"label",required:!1,type:{name:"string"}},helperText:{defaultValue:null,description:"Helper text to display with the input",name:"helperText",required:!1,type:{name:"string"}},errors:{defaultValue:null,description:"An array of string error messages",name:"errors",required:!1,type:{name:"string | string[]"}}}}}catch{}export{w as F};
