import{g as R}from"./_commonjsHelpers-BosuxZz1.js";import{k as B,s as C}from"./select-or-matches-BLLALKpn.js";import{a as P,d as k,e as w,o as q,b as T,s as x,c as U}from"./config-BXli1stc.js";import{a as H}from"./active-element-CTMAq7ve.js";var F=function(e,t){return function(a){if(e!==a.target&&!e.contains(a.target))return t.call(this,a)}},j={behavior:P,delegate:k,delegateAll:w,ignore:F,keymap:B};const V=q,{keymap:Y}=j,W=T,G=x,m=H,X='a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]',z=r=>{const e=G(X,r),t=e[0],o=e[e.length-1];function a(s){m()===o&&(s.preventDefault(),t.focus())}function i(s){m()===t?(s.preventDefault(),o.focus()):e.includes(m())||(s.preventDefault(),t.focus())}return{firstTabStop:t,lastTabStop:o,tabAhead:a,tabBack:i}};var J=(r,e={})=>{const t=z(r),o=e,{Esc:a,Escape:i}=o;i&&!a&&(o.Esc=i);const s=Y(V({Tab:t.tabAhead,"Shift+Tab":t.tabBack},e));return W({keydown:s},{init(){t.firstTabStop&&t.firstTabStop.focus()},update(d){d?this.on():this.off()}})},K=function(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);const t=document.createElement("div");e.appendChild(t);const o=`${e.offsetWidth-t.offsetWidth}px`;return e.parentNode.removeChild(e),o};const u=C,v=J,Q=K,Z=T,{prefix:tt}=U,b=`${tt}-modal`,D=`${b}-overlay`,A=`${b}-wrapper`,$="data-open-modal",E="data-close-modal",f="data-force-action",h="data-modal-hidden",S=`.${b}`,L=`.${A} *[data-focus]`,O=`${A} *[${E}]`,et=`*[${$}][aria-controls]`,ot=`${O}, .${D}:not([${f}])`,rt=`body > *:not(.${A}):not([aria-hidden])`,at=`[${h}]`,_="usa-js-modal--active",st="usa-js-no-click",it="is-visible",N="is-hidden";let c,I,g;const ct=()=>document.body.classList.contains(_),nt=Q(),lt=()=>{c.toggleModal.call(c,!1)},dt=()=>{I=window.getComputedStyle(document.body).getPropertyValue("padding-right"),g=`${parseInt(I.replace(/px/,""),10)+parseInt(nt.replace(/px/,""),10)}px`};function p(r){let e,t=r.target;const{body:o}=document,a=!ct(),i=t?t.getAttribute("aria-controls"):document.querySelector(".usa-modal-wrapper.is-visible"),s=a?document.getElementById(i):document.querySelector(".usa-modal-wrapper.is-visible");if(!s)return!1;const n=s.querySelector(L)?s.querySelector(L):s.querySelector(".usa-modal"),d=document.getElementById(s.getAttribute("data-opener")),M=o.querySelector(et),y=s.getAttribute(f);return r.type==="keydown"&&s!==null&&(t=s.querySelector(O)),t&&(t.hasAttribute($)&&(this.getAttribute("id")===null?(e=`modal-${Math.floor(Math.random()*9e5)+1e5}`,this.setAttribute("id",e)):e=this.getAttribute("id"),s.setAttribute("data-opener",e)),t.closest(`.${b}`)&&!(t.hasAttribute(E)||t.closest(`[${E}]`)))?!1:(o.classList.toggle(_,a),s.classList.toggle(it,a),s.classList.toggle(N,!a),y&&o.classList.toggle(st,a),o.style.paddingRight===g?o.style.removeProperty("padding-right"):o.style.paddingRight=g,a&&n?(y?c.focusTrap=v(s):c.focusTrap=v(s,{Escape:lt}),c.focusTrap.update(a),n.focus(),document.querySelectorAll(rt).forEach(l=>{l.setAttribute("aria-hidden","true"),l.setAttribute(h,"")})):!a&&M&&d&&(document.querySelectorAll(at).forEach(l=>{l.removeAttribute("aria-hidden"),l.removeAttribute(h)}),d.focus(),c.focusTrap.update(a)),a)}const ut=r=>{const e=r.getAttribute("id"),t=document.createElement("div"),o=Array.from(r.attributes);return dt(),t.setAttribute("data-placeholder-for",e),t.style.display="none",t.setAttribute("aria-hidden","true"),o.forEach(a=>{t.setAttribute(`data-original-${a.name}`,a.value)}),t},ft=(r,e)=>{const t=r.getAttribute("id"),o=r.getAttribute("aria-labelledby"),a=r.getAttribute("aria-describedby"),i=r.hasAttribute(f);if(!o)throw new Error(`${t} is missing aria-labelledby attribute`);if(!a)throw new Error(`${t} is missing aria-desribedby attribute`);return e.setAttribute("role","dialog"),e.setAttribute("id",t),e.setAttribute("aria-labelledby",o),e.setAttribute("aria-describedby",a),i&&e.setAttribute(f,i),e.querySelectorAll(ot).forEach(n=>{n.setAttribute("aria-controls",t)}),r.removeAttribute("id"),r.removeAttribute("aria-labelledby"),r.removeAttribute("aria-describedby"),r.setAttribute("tabindex","-1"),e},bt=r=>{const e=r,t=document.createElement("div"),o=document.createElement("div");return t.classList.add(N,A),o.classList.add(D),t.append(o),o.append(e),ft(e,t),t},At=r=>{if(!r.getAttribute("id"))throw new Error("Modal markup is missing ID");const t=ut(r);r.after(t);const o=bt(r);document.body.appendChild(o)},mt=r=>{const e=r,t=e.parentElement.parentElement,o=t.getAttribute("id");if(!o)return;const a=document.querySelector(`[data-placeholder-for="${o}"]`);a&&(Array.from(a.attributes).forEach(s=>{s.name.startsWith("data-original-")&&e.setAttribute(s.name.substr(14),s.value)}),a.after(e),a.parentElement.removeChild(a)),t.parentElement.removeChild(t)};c=Z({},{init(r){u(S,r).forEach(e=>{const t=e.id;At(e),u(`[aria-controls="${t}"]`,document).forEach(o=>{o.nodeName==="A"&&(o.setAttribute("role","button"),o.addEventListener("click",a=>a.preventDefault())),o.addEventListener("click",p)})})},teardown(r){u(S,r).forEach(e=>{const t=e.id;mt(e),u(`[aria-controls="${t}"]`,document).forEach(o=>o.removeEventListener("click",p))})},focusTrap:null,toggleModal:p});var pt=c;const vt=R(pt);export{J as f,vt as m,K as s};
