import{j as U}from"./jsx-runtime--26OcTxz.js";import{g as W}from"./_commonjsHelpers-BosuxZz1.js";import{s as j}from"./select-or-matches-Bu-g4rUn.js";import{b as Z,c as X}from"./config-BXli1stc.js";import{s as Y}from"./sanitizer-BtXph-xc.js";import{r as x}from"./index-BLgStI3F.js";const y=j,k=Z,S=Y,{prefix:a}=X,_=`${a}-file-input`,L=`.${_}`,F=`${a}-file-input__input`,I=`${a}-file-input__target`,N=`.${F}`,z=`${a}-file-input__box`,w=`${a}-file-input__instructions`,M=`${a}-file-input__preview`,H=`${a}-file-input__preview-heading`,$=`${a}-file-input--disabled`,Q=`${a}-file-input__choose`,V=`${a}-file-input__accepted-files-message`,P=`${a}-file-input__drag-text`,E=`${a}-file-input--drag`,D="is-loading",v="has-invalid-file",A=`${a}-file-input__preview-image`,J=`${A}--generic`,K=`${A}--pdf`,ee=`${A}--word`,te=`${A}--video`,se=`${A}--excel`,B=`${a}-sr-only`,m="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";let b=!0,C="",T="";const g=e=>{const t=e.closest(L);if(!t)throw new Error(`Element is missing outer ${L}`);const s=t.querySelector(N);return{dropZoneEl:t,inputEl:s}},ne=e=>{const{dropZoneEl:t,inputEl:s}=g(e);s.disabled=!0,t.classList.add($)},ie=e=>{const{dropZoneEl:t}=g(e);t.classList.add($)},re=e=>{const{dropZoneEl:t,inputEl:s}=g(e);s.disabled=!1,t.classList.remove($),t.removeAttribute("aria-disabled")},ae=e=>{const t=e.charCodeAt(0);return t===32?"-":t>=65&&t<=90?`img_${e.toLowerCase()}`:`__${t.toString(16).slice(-4)}`},oe=e=>e.replace(/[^a-z0-9]/g,ae),ce=e=>`${e}-${Math.floor(Date.now().toString()/1e3)}`,q=e=>e.hasAttribute("multiple")?"files":"file",le=e=>{const t=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div");return e.classList.remove(_),e.classList.add(F),t.classList.add(_),n.classList.add(z),s.classList.add(I),s.prepend(n),e.parentNode.insertBefore(s,e),e.parentNode.insertBefore(t,s),s.appendChild(e),t.appendChild(s),s},de=e=>{const t=e.closest(L),s=q(e),n=document.createElement("div"),i=`Drag ${s} here or`,l="choose from folder";return C=`${i} ${l}`,n.classList.add(w),n.setAttribute("aria-hidden","true"),e.setAttribute("aria-label",C),n.innerHTML=S.escapeHTML`<span class="${P}">${i}</span> <span class="${Q}">${l}</span>`,e.parentNode.insertBefore(n,e),(/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.querySelector(`.${P}`).outerHTML=""),n},ue=e=>{const t=document.createElement("div"),s=q(e),n=e.closest(L),i=e.closest(`.${I}`);T=`No ${s} selected.`,t.classList.add(B),t.setAttribute("aria-live","polite"),t.textContent=T,n.insertBefore(t,i)},pe=e=>{const t=e.hasAttribute("aria-disabled")||e.hasAttribute("disabled"),s=le(e),n=de(e),{dropZoneEl:i}=g(e);return t?i.classList.add($):ue(e),{instructions:n,dropTarget:s}},G=(e,t)=>{const s=e.querySelectorAll(`.${M}`),n=e.querySelector(`.${H}`),i=e.querySelector(`.${V}`),l=o=>{o.parentNode.removeChild(o)};n&&(n.outerHTML=""),i&&(i.outerHTML="",e.classList.remove(v)),s!==null&&(t&&t.removeAttribute("hidden"),Array.prototype.forEach.call(s,l))},fe=(e,t,s)=>{const n=e;let i=T;t.length===1?i=`You have selected the file: ${s}`:t.length>1&&(i=`You have selected ${t.length} files: ${s.join(", ")}`),setTimeout(()=>{n.textContent=i},1e3)},me=(e,t)=>{const s=document.createElement("div"),n=e.closest(`.${I}`),i=n.querySelector(`.${w}`);let l="Change file",o="";t.length===1?o=S.escapeHTML`Selected file <span class="usa-file-input__choose">${l}</span>`:t.length>1&&(l="Change files",o=S.escapeHTML`${t.length} files selected <span class="usa-file-input__choose">${l}</span>`),i.setAttribute("hidden","true"),s.classList.add(H),s.innerHTML=o,n.insertBefore(s,i),e.setAttribute("aria-label",l)},Ae=(e,t,s,n)=>{const i=e.target.files,o=n.closest(`.${_}`).querySelector(`.${B}`),u=[];G(n,s);for(let c=0;c<i.length;c+=1){const p=new FileReader,r=i[c].name;let f;u.push(r),p.onloadstart=function(){f=ce(oe(r)),s.insertAdjacentHTML("afterend",S.escapeHTML`<div class="${M}" aria-hidden="true">
          <img id="${f}" src="${m}" alt="" class="${A} ${D}"/>${r}
        <div>`)},p.onloadend=function(){const d=document.getElementById(f);r.indexOf(".pdf")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${K}")`):r.indexOf(".doc")>0||r.indexOf(".pages")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${ee}")`):r.indexOf(".xls")>0||r.indexOf(".numbers")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${se}")`):r.indexOf(".mov")>0||r.indexOf(".mp4")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${te}")`):d.setAttribute("onerror",`this.onerror=null;this.src="${m}"; this.classList.add("${J}")`),d.classList.remove(D),d.src=p.result},i[c]&&p.readAsDataURL(i[c])}i.length===0?t.setAttribute("aria-label",C):me(t,i),fe(o,i,u)},he=(e,t,s,n)=>{const i=t.getAttribute("accept");n.classList.remove(v);const l=(o,u)=>{let c=!1;return o.indexOf(u)>=0&&(c=!0),c};if(i){const o=i.split(","),u=document.createElement("div");let c=!0;const p=e.target.files||e.dataTransfer.files;for(let r=0;r<p.length;r+=1){const f=p[r];if(c)for(let h=0;h<o.length;h+=1){const d=o[h];if(c=f.name.indexOf(d)>0||l(f.type,d.replace(/\*/g,"")),c){b=!0;break}}else break}c||(G(n,s),t.value="",n.insertBefore(u,t),u.textContent=t.dataset.errormessage||"This is not a valid file type.",u.classList.add(V),n.classList.add(v),b=!1,e.preventDefault(),e.stopPropagation())}},_e=(e,t,s,n)=>{he(e,t,s,n),b===!0&&Ae(e,t,s,n)},Le=k({},{init(e){y(L,e).forEach(t=>{const{instructions:s,dropTarget:n}=pe(t);n.addEventListener("dragover",function(){this.classList.add(E)},!1),n.addEventListener("dragleave",function(){this.classList.remove(E)},!1),n.addEventListener("drop",function(){this.classList.remove(E)},!1),t.addEventListener("change",i=>_e(i,t,s,n),!1)})},teardown(e){y(N,e).forEach(t=>{const s=t.parentElement.parentElement;s.parentElement.replaceChild(t,s),t.className=_})},getFileInputContext:g,disable:ne,ariaDisable:ie,enable:re});var ge=Le;const R=W(ge),O=e=>{const t=x.useRef(null);return x.useLayoutEffect(()=>{const s=t.current;return R.on(s),()=>R.off(s)},[]),U.jsx("input",{className:"usa-file-input",type:"file",ref:t,...e})};try{O.displayName="FileInput",O.__docgenInfo={description:"File input allows users to attach one or multiple files.",displayName:"FileInput",props:{id:{defaultValue:null,description:"The unique identifier for this component",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"The name for the file input field",name:"name",required:!1,type:{name:"string"}}}}}catch{}try{fileinput.displayName="fileinput",fileinput.__docgenInfo={description:"File input allows users to attach one or multiple files.",displayName:"fileinput",props:{id:{defaultValue:null,description:"The unique identifier for this component",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"The name for the file input field",name:"name",required:!1,type:{name:"string"}}}}}catch{}export{O as F};
