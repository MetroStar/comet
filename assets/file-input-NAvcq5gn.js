import{j as G}from"./jsx-runtime-CKrituN3.js";import{g as U}from"./_commonjsHelpers-BosuxZz1.js";import{s as W}from"./select-or-matches-Bu-g4rUn.js";import{b as j,c as Z}from"./config-BXli1stc.js";import{s as X}from"./sanitizer-BtXph-xc.js";import{r as P}from"./index-CBqU2yxZ.js";const D=W,Y=j,S=X,{prefix:o}=Z,h=`${o}-file-input`,_=`.${h}`,F=`${o}-file-input__input`,x=`${o}-file-input__target`,y=`.${F}`,k=`${o}-file-input__box`,M=`${o}-file-input__instructions`,w=`${o}-file-input__preview`,N=`${o}-file-input__preview-heading`,$=`${o}-file-input--disabled`,z=`${o}-file-input__choose`,H=`${o}-file-input__accepted-files-message`,I=`${o}-file-input__drag-text`,E=`${o}-file-input--drag`,R="is-loading",v="has-invalid-file",m=`${o}-file-input__preview-image`,Q=`${m}--generic`,J=`${m}--pdf`,K=`${m}--word`,ee=`${m}--video`,te=`${m}--excel`,B=`${o}-sr-only`,A="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";let b=!0,C="",T="";const g=e=>{const t=e.closest(_);if(!t)throw new Error(`Element is missing outer ${_}`);const s=t.querySelector(y);return{dropZoneEl:t,inputEl:s}},se=e=>{const{dropZoneEl:t,inputEl:s}=g(e);s.disabled=!0,t.classList.add($)},ne=e=>{const{dropZoneEl:t}=g(e);t.classList.add($)},re=e=>{const{dropZoneEl:t,inputEl:s}=g(e);s.disabled=!1,t.classList.remove($),t.removeAttribute("aria-disabled")},ie=e=>{const t=e.charCodeAt(0);return t===32?"-":t>=65&&t<=90?`img_${e.toLowerCase()}`:`__${t.toString(16).slice(-4)}`},oe=e=>e.replace(/[^a-z0-9]/g,ie),ae=e=>`${e}-${Math.floor(Date.now().toString()/1e3)}`,V=e=>e.hasAttribute("multiple")?"files":"file",ce=e=>{const t=document.createElement("div"),s=document.createElement("div"),n=document.createElement("div");return e.classList.remove(h),e.classList.add(F),t.classList.add(h),n.classList.add(k),s.classList.add(x),s.prepend(n),e.parentNode.insertBefore(s,e),e.parentNode.insertBefore(t,s),s.appendChild(e),t.appendChild(s),s},le=e=>{const t=e.closest(_),s=V(e),n=document.createElement("div"),r=`Drag ${s} here or`,l="choose from folder";return C=`${r} ${l}`,n.classList.add(M),n.setAttribute("aria-hidden","true"),e.setAttribute("aria-label",C),n.innerHTML=S.escapeHTML`<span class="${I}">${r}</span> <span class="${z}">${l}</span>`,e.parentNode.insertBefore(n,e),(/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.querySelector(`.${I}`).outerHTML=""),n},de=e=>{const t=document.createElement("div"),s=V(e),n=e.closest(_),r=e.closest(`.${x}`);T=`No ${s} selected.`,t.classList.add(B),t.setAttribute("aria-live","polite"),t.textContent=T,n.insertBefore(t,r)},ue=e=>{const t=e.hasAttribute("aria-disabled")||e.hasAttribute("disabled"),s=ce(e),n=le(e),{dropZoneEl:r}=g(e);return t?r.classList.add($):de(e),{instructions:n,dropTarget:s}},q=(e,t)=>{const s=e.querySelectorAll(`.${w}`),n=e.querySelector(`.${N}`),r=e.querySelector(`.${H}`),l=a=>{a.parentNode.removeChild(a)};n&&(n.outerHTML=""),r&&(r.outerHTML="",e.classList.remove(v)),s!==null&&(t&&t.removeAttribute("hidden"),Array.prototype.forEach.call(s,l))},fe=(e,t,s)=>{const n=e;let r=T;t.length===1?r=`You have selected the file: ${s}`:t.length>1&&(r=`You have selected ${t.length} files: ${s.join(", ")}`),setTimeout(()=>{n.textContent=r},1e3)},pe=(e,t)=>{const s=document.createElement("div"),n=e.closest(`.${x}`),r=n.querySelector(`.${M}`);let l="Change file",a="";t.length===1?a=S.escapeHTML`Selected file <span class="usa-file-input__choose">${l}</span>`:t.length>1&&(l="Change files",a=S.escapeHTML`${t.length} files selected <span class="usa-file-input__choose">${l}</span>`),r.setAttribute("hidden","true"),s.classList.add(N),s.innerHTML=a,n.insertBefore(s,r),e.setAttribute("aria-label",l)},Ae=(e,t,s,n)=>{const r=e.target.files,a=n.closest(`.${h}`).querySelector(`.${B}`),u=[];q(n,s);for(let c=0;c<r.length;c+=1){const f=new FileReader,i=r[c].name;let p;u.push(i),f.onloadstart=function(){p=ae(oe(i)),s.insertAdjacentHTML("afterend",S.escapeHTML`<div class="${w}" aria-hidden="true">
          <img id="${p}" src="${A}" alt="" class="${m} ${R}"/>${i}
        <div>`)},f.onloadend=function(){const d=document.getElementById(p);i.indexOf(".pdf")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${A}"; this.classList.add("${J}")`):i.indexOf(".doc")>0||i.indexOf(".pages")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${A}"; this.classList.add("${K}")`):i.indexOf(".xls")>0||i.indexOf(".numbers")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${A}"; this.classList.add("${te}")`):i.indexOf(".mov")>0||i.indexOf(".mp4")>0?d.setAttribute("onerror",`this.onerror=null;this.src="${A}"; this.classList.add("${ee}")`):d.setAttribute("onerror",`this.onerror=null;this.src="${A}"; this.classList.add("${Q}")`),d.classList.remove(R),d.src=f.result},r[c]&&f.readAsDataURL(r[c])}r.length===0?t.setAttribute("aria-label",C):pe(t,r),fe(a,r,u)},me=(e,t,s,n)=>{const r=t.getAttribute("accept");n.classList.remove(v);const l=(a,u)=>{let c=!1;return a.indexOf(u)>=0&&(c=!0),c};if(r){const a=r.split(","),u=document.createElement("div");let c=!0;const f=e.target.files||e.dataTransfer.files;for(let i=0;i<f.length;i+=1){const p=f[i];if(c)for(let L=0;L<a.length;L+=1){const d=a[L];if(c=p.name.indexOf(d)>0||l(p.type,d.replace(/\*/g,"")),c){b=!0;break}}else break}c||(q(n,s),t.value="",n.insertBefore(u,t),u.textContent=t.dataset.errormessage||"This is not a valid file type.",u.classList.add(H),n.classList.add(v),b=!1,e.preventDefault(),e.stopPropagation())}},Le=(e,t,s,n)=>{me(e,t,s,n),b===!0&&Ae(e,t,s,n)},he=Y({},{init(e){D(_,e).forEach(t=>{const{instructions:s,dropTarget:n}=ue(t);n.addEventListener("dragover",function(){this.classList.add(E)},!1),n.addEventListener("dragleave",function(){this.classList.remove(E)},!1),n.addEventListener("drop",function(){this.classList.remove(E)},!1),t.addEventListener("change",r=>Le(r,t,s,n),!1)})},teardown(e){D(y,e).forEach(t=>{const s=t.parentElement.parentElement;s.parentElement.replaceChild(t,s),t.className=h})},getFileInputContext:g,disable:se,ariaDisable:ne,enable:re});var _e=he;const O=U(_e),ge=e=>{const t=P.useRef(null);return P.useLayoutEffect(()=>{const s=t.current;return O.on(s),()=>O.off(s)},[]),G.jsx("input",{className:"usa-file-input",type:"file",ref:t,...e})};ge.__docgenInfo={description:"File input allows users to attach one or multiple files.",methods:[],displayName:"FileInput",props:{id:{required:!0,tsType:{name:"string"},description:"The unique identifier for this component"},name:{required:!1,tsType:{name:"string"},description:"The name for the file input field"}}};export{ge as F};
